{% extends "filmproject/base_template.html" %}
{% load static %}

{% block content %}
<div class="container my-4">
    <div class="row">
        <!-- Left Column: Profile Picture and Friends (tighter to the left) -->
        <div class="col-md-3"> <!-- Narrower left column -->
            <!-- Profile Picture Section -->
            <div class="profile-section mb-4">
                <h2>{{ viewer.name }}'s Profile</h2>
                {% if viewer.profile_picture %}
                    <img src="{{ viewer.profile_picture.url }}" alt="Profile Picture" class="profile-picture img-fluid rounded">
                {% else %}
                    <img src="{% static 'images/default_pfp.jpg' %}" alt="Default Profile Picture" class="profile-picture img-fluid rounded">
                {% endif %}
            </div>

            
            <!-- Add Friend Button -->
            {% if user.is_authenticated and user.viewer != viewer and not is_friend %}
                <a href="{% url 'send_friend_request' viewer.id %}" class="btn btn-primary btn-block mb-3">Add Friend</a>
            {% endif %}

            <!-- Friends List Section -->
            <div class="friends-section">
                <h2>Friends</h2>
                <ul class="list-group">
                    {% for friend in viewer.friends.all %}
                        <li class="list-group-item">
                            <a href="{% url 'profile_viewer' friend.id %}">{{ friend.name }}</a>
                            <!-- Only show Remove Friend button if the user is viewing their own profile -->
                            {% if user.viewer == viewer %}
                                <a href="{% url 'remove_friend' friend.id %}" class="btn btn-danger btn-sm">Remove Friend</a>
                            {% endif %}
                        </li>
                    {% empty %}
                        <li class="list-group-item">No friends yet.</li>
                    {% endfor %}
                </ul>
            </div>
        </div>

        <!-- Right Column: Watchlist and Seen Films Carousels (wider space for movies) -->
        <div class="col-md-9"> <!-- Wider right column for movies -->
            <!-- Watchlist Section -->
            <div class="watchlist-section mb-4">
                <h2>Watchlist</h2>
                {% if watchlist %}
                    <div id="watchlistCarousel" class="carousel slide" data-bs-ride="carousel">
                        <div class="carousel-inner" id="watchlist">
                            <!-- Movies will be dynamically added here -->
                        </div>
                        <button class="carousel-control-prev" type="button" data-bs-target="#watchlistCarousel" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#watchlistCarousel" data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                        </button>                        
                    </div>
                {% else %}
                    <p>This viewer has no films in their watchlist.</p>
                {% endif %}
            </div>

            <!-- Seen Films Section -->
            <div class="seen-films-section">
                <h2>Seen Films</h2>
                {% if seen_films %}
                    <div id="seenFilmsCarousel" class="carousel slide" data-bs-ride="carousel">
                        <div class="carousel-inner" id="seenFilms">
                            <!-- Movies will be dynamically added here -->
                        </div>
                        <button class="carousel-control-prev" type="button" data-bs-target="#seenFilmsCarousel" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#seenFilmsCarousel" data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                {% else %}
                    <p>This viewer has not marked any films as seen yet.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- External JavaScript file -->
<script src="{% static 'scripts/carosel.js' %}"></script>

{% endblock %}
